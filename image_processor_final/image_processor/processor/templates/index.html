<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Chart Filter </title>
    <meta name="description" content="Filter Image Through User Query">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <link href="{{ url_for('static',filename='css/AdminLTE.min.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ url_for('static',filename='css/bootstrap.min.css') }}" rel="stylesheet" type="text/css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
</head>

<body class="skin-black">
    <div class="content-wrapper" style="margin-left: 0;">
        <section class="content-header">
                <h1>Chart Filter & Analysis</h1>
        </section>
        <section class="content">
            <div class="row">
                <div class="col-md-12">
                    <div class="box box-info">
                            <div class="box-header with-border">
                                <h3 class="box-title">Select Filter</h3>
                            </div>
                            <div class="box-body">
                                <form class="cotact-form" id="myform" enctype="multipart/form-data">
                                    <div class="row">
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label>Chart Type:</label>
                                                <select id = "chartType" class="form-control">
                                                    <option value="all">All</option>
                                                    <option value="scatterPlot">Scatter Plot</option>
                                                    <option value="boxAndWhiskers">Box and Whiskers</option>
                                                    <option value="connectedScatterPlot">Connected Scatter Plot</option>
                                                    <option value="barGraph">Bar Graph</option>
                                                    <option value="areaChart">Area Chart</option>
                                                    <option value="alluvialDiagram">Alluvial Diagram</option>
                                                    <option value="bubbleChart">Bubble Chart</option>
                                                    <option value="dotDistributionMap">Dot Distribution Map</option>
                                                    <option value="heatMap">Heat Map</option>
                                                    <option value="isarithmicMap">Isarithmic Map</option>
                                                    <option value="isopleth">Isopleth</option>
                                                    <option value="lineChart">Line Chart</option>
                                                    <option value="model">Model</option>
                                                    <option value="None">None</option>
                                                    <option value="pieChart">Pie Chart</option>
                                                    <option value="proportionalSymbolMap">Proportional Symbol Map</option>
                                                    <option value="polarAre">Polar Are</option>
                                                    <option value="stackBarChart">Stack Bar Chart</option>
                                                    <option value="stepChart">Step Chart</option>
                                                    <option value="timeSeries">Time Series</option>
                                                    <option value="unknown">Unknown</option>
                                                    <option value="waterfallChart">Waterfall Chart</option>
                                                    <option value="wedgeStackGraph">Wedge Stack Graph</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label>Secondary Chart Type:</label>
                                                <select id = "secondChartType" class="form-control">
                                                    <option value="all">All</option>
                                                    <option value="scatterPlot">Scatter Plot</option>
                                                    <option value="boxAndWhiskers">Box and Whiskers</option>
                                                    <option value="connectedScatterPlot">Connected Scatter Plot</option>
                                                    <option value="barGraph">Bar Graph</option>
                                                    <option value="areaChart">Area Chart</option>
                                                    <option value="alluvialDiagram">Alluvial Diagram</option>
                                                    <option value="bubbleChart">Bubble Chart</option>
                                                    <option value="dotDistributionMap">Dot Distribution Map</option>
                                                    <option value="heatMap">Heat Map</option>
                                                    <option value="isarithmicMap">Isarithmic Map</option>
                                                    <option value="isopleth">Isopleth</option>
                                                    <option value="lineChart">Line Chart</option>
                                                    <option value="model">Model</option>
                                                    <option value="None">None</option>
                                                    <option value="pieChart">Pie Chart</option>
                                                    <option value="proportionalSymbolMap">Proportional Symbol Map</option>
                                                    <option value="polarAre">Polar Are</option>
                                                    <option value="stackBarChart">Stack Bar Chart</option>
                                                    <option value="stepChart">Step Chart</option>
                                                    <option value="timeSeries">Time Series</option>
                                                    <option value="unknown">Unknown</option>
                                                    <option value="waterfallChart">Waterfall Chart</option>
                                                    <option value="wedgeStackGraph">Wedge Stack Graph</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-md-2">
                                            <div class="form-group">
                                                <label>Year:</label>
                                                <select id="Year" class="form-control">
                                                    <option value="all">All</option>
                                                    <option value="2007">2007</option>
                                                    <option value="2012">2012</option>
                                                    <option value="2014">2014</option>
                                                    <option value="2017">2017</option>
                                                    <option value="2018">2018</option>
                                                </select>
                                            </div>
                                        </div>
                                    <!--/div-->
                    
                                    <!--div class="row"-->
                                        <div class="col-md-6">
                                            <div class="form-group">
                                                <label>PDF Source:</label>
                                                <select id="PDF" class="form-control">
                                                    <option value="all">All</option>
                                                    <option value="PDF1">Climate Science Special Report Volume 1</option>
                                                    <option value="PDF2">Special Report: Global Warming of 1.5c Chapter 1 Framing and Context</option>
                                                    <option value="PDF3">Special Report: Global Warming of 1.5c Chapter 2 Mitigation Pathways Compatible with 1.5�C in the Context of Sustainable Development</option>
                                                    <option value="PDF4">Special Report: Global Warming of 1.5c Chapter 3 Impacts of 1.5C of Global Warming on Natural and Human Systems</option>
                                                    <option value="PDF5">Special Report: Global Warming of 1.5c Chapter 4 Strengthening and Implementing the Global Response</option>
                                                    <option value="PDF6">Special Report: Global Warming of 1.5c Chapter 5 Sustainable Development, Poverty Eradication and Reducing Inequalities</option>
                                                    <option value="PDF7">Climate Change 2014 Synthesis Report</option>
                                                    <option value="PDF8">Climate Change 2014 Impacts, Adaptation, and Vulnerability Part A: Global and Sectoral Aspects</option>
                                                    <option value="PDF9">Managing the Risks of Extreme Events and Disasters to Advance Climate Change Adaptation</option>
                                                    <option value="PDF10">Renewable Energy Sources and Climate Change Mitigation</option>
                                                    <option value="PDF11">Climate Change 2007 Synthesis Report</option>
                                                    <option value="PDF12">Climate Change 2007: Impacts, Adaptation and Vulnerability</option>
                                                    <option value="PDF13">Climate Change 2007 Mitigation</option>
                                                    <option value="PDF14">2007 The Physical Science Basis</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="box-footer">
                                        <button id="filter" type="button" class="btn btn-primary">Filter</button>
                                    </div>
                                    
                                        
                                </form>
                                <!--form action="/export/" method="post">
                                    <div class="box-footer">
                                        <button id="export" type="button" class="btn btn-primary" style="float: right;">Export</button>
                                    </div>
                                </form-->
                            </div>
                    </div>
                </div>
            </div>
        
    
        <div class="row">
            <div class="col-md-12">
                <div class="" id="imgBody">
                    <span class="profile-picture" id="imgDiv">
                           
                    </span>
                </div>
            </div>
        </div>

    <!--    {% if filter_images %}-->
    <!--        {% for image in filter_images %}-->
    <!--            <a id="{{ image[0] }}"><img src="{{ image[7] }}" /></a>-->
    <!--        {% endfor %}-->
    <!--    {% endif %}-->

    
    <script type="text/javascript">
        img_data = {}
        $(document).ready(function() {
            //$("#chart-data").modal();
            $('#filter').bind('click', function () {
                $.ajax({
                    url:"{{ url_for('home') }}",
                    data: {
                        chartType:$('#chartType option:selected').text(),
                        secondChartType:$('#secondChartType option:selected').text(),
                        PDF:$('#PDF option:selected').text(),
                        Year:$('#Year').val()},
                    type:'POST',
                    sync: true,
                    success: function(response) {
                        $("#imgBody").show();
                        var data = JSON.parse(response);
                        $("#imgDiv").html('');
                        for (var i = 0, j = data.length; i < j; i++){
                            img_data[data[i][0]] = data[i];
                            var img_html = '<img class="editable img-responsive" width="300px" height="300px" halt="dp" src="' + data[i][1] + '" </img>';
                            var a_html = '<a class="space space-4"  href="#chart-data" data-toggle="modal" data-target="#chart-data" value="' + data[i][0] + '" onclick=showModal('+data[i][0]+')>' + img_html+'</a>';
                            $('#imgDiv').append(a_html);
                        }
                    },
                    error:function (error) {
                        console.log(error);
                    }
                });
            });
        });
        function showModal(index)
        {
            $('#name').val("");
            $('#email').val("");
            $("input[name='linkert1']").val();
            $("input[name='linkert2']").val();
            $("input[name='linkert3']").val();
            $("input[name='linkert4']").val();
            $('#comment').val("");
            $('#occupation').val("Student");
           data = img_data[index];
           console.log(data);
           $("#modal-img").attr("src",data[1]);
           $("#chart-info").text(data[2]);
           $("#img-id").val(data[0]);
           $('#form-submit').bind('click', function () {
                $.ajax({
                    url:"{{ url_for('home') }}"+"feedback",
                    data: {
                        name:$('#name').val(),
                        email:$('#email').val(),
                        linkert1:$("input[name='linkert1']:checked").val(),
                        linkert2:$("input[name='linkert2']:checked").val(),
                        linkert3:$("input[name='linkert3']:checked").val(),
                        linkert4:$("input[name='linkert4']:checked").val(),
                        image_key:data[0],
                        feedback:$('#comment').val(),
			            occupation:$('#occupation').val(),
                    },
                    type:'POST',
                    sync: true,
                    success: function(response) {
                        console.log(response)
                        $("#close").click();
                    }
                });
           });
        }
    </script>
        </section>
    </div>

    <!-- Chart Information Modal -->
    <div class="modal fade" id="chart-data" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="close">
                <span aria-hidden="true">×</span></button>
                <h4 class="modal-title">Chart Information</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6"><img id="modal-img" src="" class="modal-img" height="250" width="300"/></div>
                    <div class="col-md-6"><p class="chart-info" id="chart-info"></p></div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <form class="user-form" id="userForm" method="POST" action="" enctype="multipart/form-data">
                            <div class="form-group">
                                <label>Name</label>
                                <input type="text" class="form-control" name="name" id="name" placeholder="Please enter name">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="text" class="form-control" name="email" id="email" placeholder="Please enter email">
                            </div>
			    <div class="form-group">
                                <label>Occupation</label>
				<select id="occupation" name="occupation" class="form-control">
                                                    <option value="Student">Student</option>
                                                    <option value="Scientist">Scientist</option>
                                                    <option value="Mathematician">Mathematician</option>
                                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <input type="hidden" id="img-id" name="img-id" /> 
                            <!--div class="form-group">
                                <label>How much easy the graph is to understand?</label>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="rating" value="1"/> Very Easy
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="rating" value="2"/> Easy
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="rating" checked value="3"/> Neither Easy nor Difficult
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="rating" value="4"/> Difficult
                                    </label>
                                </div>
                                <div class="radio">
                                    <label>
                                        <input type="radio" name="rating" value="5"/> Very Difficult
                                    </label>
                                </div>
                            </div-->
                            <div class="wrap">
                              <!--h1 class="linkert-header">This is a linkert Scale survey</h1-->
                              <form action="">
                                <label class="statement">How easy the graph is to understand?</label>
                                <ul class='likert'>
                                  <li>
                                    <input type="radio" name="linkert1" value="Very Easy">
                                    <label>Very Easy</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert1" value="Easy">
                                    <label>Easy</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert1" value="Neutral">
                                    <label>Neither Easy nor Difficult</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert1" value="Difficult">
                                    <label>Difficult</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert1" value="Very Difficult">
                                    <label>Very Difficult</label>
                                  </li>
                                </ul>
                                <label class="statement">Clutterness</label>
                                <ul class='likert'>
                                  <li>
                                    <input type="radio" name="linkert2" value="Very High">
                                    <label>Very High</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert2" value="High">
                                    <label>High</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert2" value="Medium">
                                    <label>Medium</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert2" value="Low">
                                    <label>Low</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert2" value="Very Low">
                                    <label>Very Low</label>
                                  </li>
                                </ul>
                                <label class="statement">Complexity</label>
                                <ul class='likert'>
                                  <li>
                                    <input type="radio" name="linkert3" value="Very High">
                                    <label>Very High</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert3" value="High">
                                    <label>High</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert3" value="Medium">
                                    <label>Medium</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert3" value="Low">
                                    <label>Low</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert3" value="Very Low">
                                    <label>Very Low</label>
                                  </li>
                                </ul>
                                <label class="statement">Appropriateness</label>
                                <ul class='likert'>
                                  <li>
                                    <input type="radio" name="linkert4" value="Very High">
                                    <label>Very High</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert4" value="High">
                                    <label>High</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert4" value="Medium">
                                    <label>Medium</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert4" value="Low">
                                    <label>Low</label>
                                  </li>
                                  <li>
                                    <input type="radio" name="linkert4" value="Very Low">
                                    <label>Very Low</label>
                                  </li>
                                </ul>
                                
                              </form>
                            </div>
                            <div class="form-group">
                                <label>Comment</label>
                                <textarea name="comment" id="comment" class="form-control" placeholder="Please enter comment"></textarea>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <!-- <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> -->
                <button type="button" class="btn btn-primary pull-left" id="form-submit">Submit</button>
            </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>

</body>
</html>
